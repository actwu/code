<!DOCTYPE html>
<html lang="en" style="color-scheme:dark">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>Pycode | Nay</title>
<meta name="description" content="Pycode | Nay">
<meta name="keywords" content="">
<meta name="author" content="Nay">
<meta name="robots" content="index, follow">
<meta name="googlebot" content="index, follow">
<meta name="referrer" content="no-referrer-when-downgrade">
<link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2064%2064'%3E%0A%3Ccircle%20cx%3D'32'%20cy%3D'32'%20r%3D'32'%20fill%3D'%23000000'%2F%3E%0A%3Ctext%20x%3D'32'%20y%3D'46'%20font-size%3D'38'%20font-weight%3D'700'%20text-anchor%3D'middle'%20fill%3D'%23ffffff'%20font-family%3D'Arial'%20letter-spacing%3D'-1'%3E%E2%98%98%EF%B8%8F%3C%2Ftext%3E%0A%3C%2Fsvg%3E">
<link rel="canonical" href="">
<meta property="og:title" content="Pycode | Nay">
<meta property="og:description" content="Pycode | Nay">
<meta property="og:image" content="">
<meta property="og:url" content="">
<meta property="og:type" content="">
<meta property="og:site_name" content="Pycode | Nay">
<meta property="og:locale" content="">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Pycode | Nay">
<meta name="twitter:description" content="Pycode | Nay">
<meta name="twitter:image" content="">
<meta name="twitter:site" content="">
<meta name="twitter:creator" content="">

<meta name='google-site-verification' content=''>
<meta name='msvalidate.01' content=''>

<link rel="manifest" href="manifest.json">

<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Organization","name":"Pycode | Nay","url":"","logo":"data:image/svg+xml,%3Csvg%20xmlns%3D'http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg'%20viewBox%3D'0%200%2064%2064'%3E%0A%3Ccircle%20cx%3D'32'%20cy%3D'32'%20r%3D'32'%20fill%3D'%23000000'%2F%3E%0A%3Ctext%20x%3D'32'%20y%3D'46'%20font-size%3D'38'%20font-weight%3D'700'%20text-anchor%3D'middle'%20fill%3D'%23ffffff'%20font-family%3D'Arial'%20letter-spacing%3D'-1'%3E%E2%98%98%EF%B8%8F%3C%2Ftext%3E%0A%3C%2Fsvg%3E","description":"Pycode | Nay"}</script>
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;outline:none;border:none;font-family:monospace;}
body{background:#000;display:flex;flex-direction:column;height:100svh;color:#fafaff;}
#dock{background:#14141c;padding:12px 18px;border-radius:28px;margin-bottom:10px;display:flex;margin:auto;gap:14px;align-items:center;justify-content:center;}
#switch{appearance:none;width:48px;height:24px;background:#24242c;border-radius:20px;position:relative;cursor:pointer;}
#switch::after{content:"";width:20px;height:20px;background:#fafaff;position:absolute;top:2px;left:2px;border-radius:50%;}
#switch:checked{background:#4aa3ff;} 
#switch:checked::after{left:26px;}
button{background:#4aa3ff;color:#fafaff;padding:.7rem 1.2rem;border-radius:9999px;cursor:pointer;}
#wrap{flex:1;display:flex;flex-direction:column;}
#left{flex:1;display:flex;flex-direction:column;}
#right{flex:1;display:flex;flex-direction:column;background:#010101;padding:12px;overflow:auto;transition:width .25s;}
#right:hover,#right:active{width:70%;}
textarea{flex:1;background:#000;color:#4aa3ff;padding:12px;font-size:16px;resize:none;font-family:monospace;}
#monaco{flex:1;height:100%;font-family:monospace;}
@media (orientation:landscape){#wrap{flex-direction:row;}#right{width:30%;}}
.monaco-editor,.monaco-editor .margin,.monaco-editor-background{background:transparent !important;}
</style>
<body>
<main id="wrap">
  <div id="left">
    <textarea id="plain" placeholder="Write Python code here..."></textarea>
    <div id="monaco" hidden></div>
  </div>
  <div id="right"></div>
</main>
<div id="dock">
  <input type="checkbox" id="switch" aria-label="Toggle editor">
  <button id="run">Run</button>
</div>

<script>
const plain = document.getElementById('plain');
const mono = document.getElementById('monaco');
const right = document.getElementById('right');
const switchInput = document.getElementById('switch');
let monacoEditor = null;

// storage helpers
const pathKey = "pyeditor_" + location.pathname.replace(/\W/g,'_');
const chunkSize = 50; // lines per chunk

function saveToLocalStorage() {
  const code = plain.value;
  const lines = code.split("\n");
  const chunks = [];
  for(let i=0;i<lines.length;i+=chunkSize){
    chunks.push(lines.slice(i,i+chunkSize).join("\n"));
  }
  localStorage.setItem(pathKey, JSON.stringify(chunks));
}

function loadFromLocalStorage() {
  const data = localStorage.getItem(pathKey);
  if(data){
    const chunks = JSON.parse(data);
    plain.value = chunks.join("\n");
  }
}

// load on start
loadFromLocalStorage();

// auto-save every 2s
setInterval(()=>{
  if(!switchInput.checked && !monacoEditor) return saveToLocalStorage();
  const code = switchInput.checked ? monacoEditor.getValue() : plain.value;
  plain.value = code; // always sync textarea
  saveToLocalStorage();
},2000);

// Monaco toggle
require.config({paths:{vs:'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs'}});
switchInput.onchange = () => {
  const use = switchInput.checked;
  plain.hidden = use;
  mono.hidden = !use;
  if(use){
    if(!monacoEditor){
      require(['vs/editor/editor.main'],()=>{
        monacoEditor = monaco.editor.create(mono,{
          value: plain.value,
          language:'python',
          theme:'vs-dark',
          minimap:{enabled:false},
          automaticLayout:true,
          fontFamily:'monospace'
        });
        monacoEditor.onDidChangeModelContent(()=>{
          plain.value = monacoEditor.getValue();
          saveToLocalStorage();
        });
      });
    } else {
      monacoEditor.setValue(plain.value);
      monacoEditor.layout();
    }
  } else if(monacoEditor){
    plain.value = monacoEditor.getValue();
  }
};

// Pyodide runner
async function loadPyodideAndRun(){ return await loadPyodide(); }
let pyodideReadyPromise = loadPyodideAndRun();

document.getElementById('run').onclick = async () => {
  const code = switchInput.checked ? monacoEditor.getValue() : plain.value;
  right.textContent = 'Runningâ€¦';
  const pyodide = await pyodideReadyPromise;
  try {
    const result = await pyodide.runPythonAsync(`
import sys
from io import StringIO
buf = StringIO()
sys.stdout = buf
sys.stderr = buf

${code}

buf.getvalue()
`);
    right.textContent = result;
  } catch(e){
    right.textContent = 'Error: ' + e;
  }
};
</script>
</body>
  </html>
