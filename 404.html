<!DOCTYPE html>
<html lang="en" style="color-scheme:dark">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Code | Nay</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Ccircle cx='32' cy='32' r='32' fill='%23000000'/%3E%3Ctext x='32' y='46' font-size='38' font-weight='700' text-anchor='middle' fill='%23ffffff' font-family='Arial' letter-spacing='-1'%3E%E2%98%98%EF%B8%8F%3C/text%3E%3C/svg%3E">
<script src="https://cdn.jsdelivr.net/pyodide/v0.23.4/full/pyodide.js"></script>
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs/loader.js"></script>
<style>
*{margin:0;padding:0;text-decoration:unset;box-sizing:border-box;outline:none;border:none;font-family:monospace;}
body{background:#000;display:flex;flex-direction:column;height:100svh;color:#fafaff;}
#dock{padding: 8px; margin-bottom:10px;display:flex;gap:14px;align-items:center;justify-content:right;}
#switch{appearance:none;width:48px;height:24px;background:#24242c;border-radius:20px;position:relative;cursor:pointer;}
#switch::after{content:"";width:20px;height:20px;background:#fafaff;position:absolute;top:2px;left:2px;border-radius:50%;}
#switch:checked{background:#4aa3ff;} 
#switch:checked::after{left:26px;}
button{background:#4aa3ff;color:#fafaff;padding:.7rem 1.2rem;border-radius:9999px;cursor:pointer;}
#wrap{flex:1;display:flex;flex-direction:column-reverse;}
#left{flex:1;display:flex;flex-direction:column;}
#right{flex:1;background:#010101;overflow:auto;transition:width .25s;display:flex;flex-direction:column;padding:12px;}
#right:hover,#right:active{width:70%;}
textarea{flex:1;background:#000;color:#4aa3ff;padding:12px;font-size:16px;resize:none;font-family:monospace;}
#monaco{flex:1;height:100%;font-family:monospace;}
@media (orientation:landscape){#wrap{flex-direction:row;}#right{width:30%;}}
.monaco-editor,.monaco-editor .margin,.monaco-editor-background{background:transparent !important;}
</style>
<body>

 
  <main id="wrap">
  <div id="left">
    <textarea id="plain" placeholder="Write code here..."></textarea>
    <div id="monaco" hidden></div>
  </div>
  <div id="right"></div>
</main>
<div id="dock">
<a style="justify-self:flex-start;flex:1;font-size:18px; font-family:Arial, sans-serif; color:#fafaff; align-items:center; gap:8px; display:flex; padding:0.1in;" id="back" href="https://actwu.github.io/code">
<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><title>arrow_left_circle_fill</title><g id="arrow_left_circle_fill" fill='none' fill-rule='evenodd'><path d='M24 0v24H0V0h24ZM12.594 23.258l-.012.002-.071.035-.02.004-.014-.004-.071-.036c-.01-.003-.019 0-.024.006l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.016-.018Zm.264-.113-.014.002-.184.093-.01.01-.003.011.018.43.005.012.008.008.201.092c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022Zm-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.003-.011.018-.43-.003-.012-.01-.01-.184-.092Z'/><path fill='#FAFAFFFF' d='M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10Zm-.005-5.758a1 1 0 0 0 0-1.414L10.168 13h6.076a1 1 0 0 0 0-2h-6.076l1.829-1.829a1 1 0 0 0-1.415-1.414l-3.535 3.536a1 1 0 0 0 0 1.414l3.535 3.535a1 1 0 0 0 1.415 0Z'/></g></svg>
Back
</a>

 <a href="#" onmousedown="document.fullscreenElement ? document.exitFullscreen() : document.documentElement.requestFullscreen()">
<svg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'><title>fullscreen_fill</title><g id="fullscreen_fill" fill='none' fill-rule='evenodd'><path d='M24 0v24H0V0zM12.593 23.258l-.011.002-.071.035-.02.004-.014-.004-.071-.035c-.01-.004-.019-.001-.024.005l-.004.01-.017.428.005.02.01.013.104.074.015.004.012-.004.104-.074.012-.016.004-.017-.017-.427c-.002-.01-.009-.017-.017-.018m.265-.113-.013.002-.185.093-.01.01-.003.011.018.43.005.012.008.007.201.093c.012.004.023 0 .029-.008l.004-.014-.034-.614c-.003-.012-.01-.02-.02-.022m-.715.002a.023.023 0 0 0-.027.006l-.006.014-.034.614c0 .012.007.02.017.024l.015-.002.201-.093.01-.008.004-.011.017-.43-.003-.012-.01-.01z'/><path fill='#FAFAFFFF' d='M18.5 5.5H16a1.5 1.5 0 0 1 0-3h3A2.5 2.5 0 0 1 21.5 5v3a1.5 1.5 0 0 1-3 0zM8 5.5H5.5V8a1.5 1.5 0 1 1-3 0V5A2.5 2.5 0 0 1 5 2.5h3a1.5 1.5 0 1 1 0 3m0 13H5.5V16a1.5 1.5 0 0 0-3 0v3A2.5 2.5 0 0 0 5 21.5h3a1.5 1.5 0 0 0 0-3m8 0h2.5V16a1.5 1.5 0 0 1 3 0v3a2.5 2.5 0 0 1-2.5 2.5h-3a1.5 1.5 0 0 1 0-3'/></g></svg>
</a>
  <input type="checkbox" id="switch" aria-label="Toggle editor">
  <button id="run">Run</button>
</div>

<script>
const plain=document.getElementById('plain')
const mono=document.getElementById('monaco')
const right=document.getElementById('right')
const switchInput=document.getElementById('switch')
const runBtn=document.getElementById('run')
let monacoEditor=null
let pyodideReadyPromise=null
let mode=''
if(location.pathname.startsWith('/code/web')) mode='html'
else if(location.pathname.startsWith('/code/py')) mode='python'
runBtn.hidden=mode==='html'
const pathKey=(mode==='html'?'projhtml_':'projpy_')+location.pathname.replace(/\W/g,'_')
const saved=localStorage.getItem(pathKey)
if(saved) plain.value=saved
function saveCode(){
  const code=switchInput.checked&&monacoEditor?monacoEditor.getValue():plain.value
  localStorage.setItem(pathKey,code)
  const prefix=mode==='html'?'projhtml_':'projpy_'
  localStorage.setItem(prefix+location.href,'true')
}
setInterval(saveCode,2000)
function updatePreview(){
  if(mode==='html'){
    const code=switchInput.checked&&monacoEditor?monacoEditor.getValue():plain.value
    right.innerHTML=''
    const iframe=document.createElement('iframe')
    iframe.srcdoc=code
    iframe.style.flex='1'
    iframe.style.border='none'
    right.appendChild(iframe)
  }
}
require.config({paths:{vs:'https://cdn.jsdelivr.net/npm/monaco-editor@0.45.0/min/vs'}})
switchInput.onchange=()=>{
  const use=switchInput.checked
  plain.hidden=use
  mono.hidden=!use
  if(use){
    if(!monacoEditor){
      require(['vs/editor/editor.main'],()=>{
        monacoEditor=monaco.editor.create(mono,{
          value:plain.value,
          language:mode==='html'?'html':'python',
          theme:'vs-dark',
          minimap:{enabled:false},
          automaticLayout:true,
          fontFamily:'monospace',
          wordWrap:'on'
        })
        monacoEditor.onDidChangeModelContent(()=>{
          plain.value=monacoEditor.getValue()
          saveCode()
          if(mode==='html') updatePreview()
        })
        if(mode==='html') updatePreview()
      })
    }else{
      monacoEditor.setValue(plain.value)
      monacoEditor.updateOptions({language:mode==='html'?'html':'python'})
    }
  }else if(monacoEditor){
    plain.value=monacoEditor.getValue()
  }
}
plain.oninput=()=>{ saveCode(); if(mode==='html') updatePreview() }
  if(mode==='html') updatePreview();
if(mode==='python') pyodideReadyPromise=loadPyodide()
runBtn.onclick=async()=>{
  if(mode!=='python') return
  const code=switchInput.checked&&monacoEditor?monacoEditor.getValue():plain.value
  right.textContent='Runningâ€¦'
  try{
    const pyodide=await pyodideReadyPromise
    const result=await pyodide.runPythonAsync(`
import sys
from io import StringIO
buf = StringIO()
sys.stdout = buf
sys.stderr = buf

${code}

buf.getvalue()
`)
    right.textContent=result
  }catch(e){
    right.textContent='Error: '+e
  }
}
</script>
</body>
</html>
